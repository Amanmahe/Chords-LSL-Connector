"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[239],{1239:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var o=n(5155),a=n(2115),i=n(819),c=n(4113),l=n(5996),s=n(7573),r=n(6818);let d=()=>{let[e,t]=(0,a.useState)(!1),n=(0,a.useRef)(null),[d,u]=(0,a.useState)(null),[x,h]=(0,a.useState)([]),[f,p]=(0,a.useState)(null),[m,b]=(0,a.useState)(""),v=(0,a.useRef)(!1),g=async()=>{try{v.current=!0,u("serial");let e=await i.I8.invoke("detect_arduino");console.log("Connected to device on port: ".concat(e)),n.current=e,t(!0),await i.I8.invoke("start_streaming",{portName:n.current,stream_name:"UDL"})}catch(e){console.error("Failed to connect to device:",e)}},y=async()=>{try{v.current=!0,u("wifi"),t(!0),await i.I8.invoke("start_wifistreaming")}catch(e){console.error("Failed to connect to device:",e)}},_=async()=>{try{v.current=!0,u("bluetooth"),await i.I8.invoke("scan_bluetooth_devices")}catch(e){console.error("Failed to connect to device:",e)}};(0,a.useEffect)(()=>{(0,r.KT)("bluetoothDevices",e=>{h(e.payload),console.log(e.payload)})},[]);let w=async()=>{f&&(b(await i.I8.invoke("connect_to_bluetooth",{deviceId:f})),t(!0))},j=async()=>{if(f)try{let e=await i.I8.invoke("disconnect_from_bluetooth",{deviceId:f});i.I8.invoke("cleanup_bluetooth").then(()=>console.log("Bluetooth cleaned up")).catch(e=>console.error("Cleanup failed:",e)),console.log(e),t(!1),p(null),u(null),b(e)}catch(e){console.error("Failed to disconnect:",e),b("Failed to disconnect.")}};return(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-200",children:[(0,o.jsxs)("div",{className:"flex space-x-10 relative",children:[(0,o.jsx)("div",{onClick:null===d?g:void 0,onMouseDown:null===d?()=>v.current=!0:void 0,className:"\n        flex items-center justify-center w-28 h-28 rounded-full cursor-pointer bg-gray-200 shadow-[8px_8px_16px_#bebebe,-8px_-8px_16px_#ffffff] \n        transition-all duration-600 relative ".concat(d&&"wifi"!==d&&"bluetooth"!==d?"animate-[rotateShadow_1.5s_linear_infinite]":"","\n        ").concat(d&&"serial"!==d?"opacity-50 pointer-events-none":"","\n      "),children:(0,o.jsx)(c.A,{size:40,className:"transition-colors duration-300 ".concat(e&&"serial"===d?"text-green-500":"text-gray-500")})}),(0,o.jsx)("div",{onClick:null===d?y:void 0,onMouseDown:null===d?()=>v.current=!0:void 0,className:"\n        flex items-center justify-center w-28 h-28 rounded-full cursor-pointer bg-gray-200 shadow-[8px_8px_16px_#bebebe,-8px_-8px_16px_#ffffff] \n        transition-all duration-600 relative ".concat(d&&"serial"!==d&&"bluetooth"!==d?"animate-[rotateShadow_1.5s_linear_infinite]":"","\n        ").concat(d&&"wifi"!==d?"opacity-50 pointer-events-none":"","\n      "),children:(0,o.jsx)(l.A,{size:40,className:"transition-colors duration-300 ".concat(e&&"wifi"===d?"text-green-500":"text-gray-500")})}),(0,o.jsx)("div",{onClick:null===d?_:void 0,onMouseDown:null===d?()=>v.current=!0:void 0,className:"\n        flex items-center justify-center w-28 h-28 rounded-full cursor-pointer bg-gray-200 shadow-[8px_8px_16px_#bebebe,-8px_-8px_16px_#ffffff] \n        transition-all duration-600 relative ".concat(d&&"serial"!==d&&"wifi"!==d?"animate-[rotateShadow_1.5s_linear_infinite]":"","\n        ").concat(d&&"bluetooth"!==d?"opacity-50 pointer-events-none":"","\n      "),children:(0,o.jsx)(s.A,{size:40,className:"transition-colors duration-300 ".concat(e&&"bluetooth"===d?"text-green-500":"text-gray-500")})})]}),"bluetooth"===d&&!e&&(0,o.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-80 max-w-full max-h-[80vh] overflow-y-auto",children:[(0,o.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Bluetooth Devices"})}),x.length>0?(0,o.jsx)("ul",{className:"space-y-2 mb-4",children:x.map(e=>(0,o.jsxs)("li",{className:"flex items-center p-2 hover:bg-gray-100 rounded",children:[(0,o.jsx)("input",{type:"radio",id:"device-".concat(e.id),name:"bluetooth-device",value:e.id,checked:f===e.id,onChange:()=>p(e.id),className:"mr-3"}),(0,o.jsx)("label",{htmlFor:"device-".concat(e.id),className:"flex-1 text-gray-700 cursor-pointer",children:e.name||"Unknown Device (".concat(e.id,")")})]},e.id))}):(0,o.jsx)("p",{className:"text-gray-500 py-4 text-center",children:"Scanning for devices..."}),(0,o.jsxs)("div",{className:"flex space-x-3",children:[(0,o.jsx)("button",{onClick:w,disabled:!f,className:"flex-1 py-2 rounded-md ".concat(f?"bg-blue-500 hover:bg-blue-600 text-white":"bg-gray-300 cursor-not-allowed"," transition-colors"),children:"Connect"}),(0,o.jsx)("button",{onClick:()=>u(null),className:"flex-1 py-2 rounded-md bg-gray-200 hover:bg-gray-300 text-gray-700 transition-colors",children:"Cancel"})]}),m&&(0,o.jsx)("p",{className:"mt-3 text-sm ".concat(m.includes("Failed")?"text-red-500":"text-gray-600"),children:m})]})}),e&&(0,o.jsx)("button",{onClick:j,className:"mt-4 px-6 py-2 bg-red-500 text-black rounded-lg shadow-lg hover:bg-red-600 transition",children:"Disconnect"})]})}}}]);